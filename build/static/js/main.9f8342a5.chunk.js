(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{49:function(t,e,n){t.exports=n(91)},54:function(t,e,n){},84:function(t,e){},91:function(t,e,n){"use strict";n.r(e);var i=n(0),o=n.n(i),s=n(11),a=n.n(s),r=n(46),c=n(7),u=n(10),h=n(13),l=n(15),m=n(14),y=n(5),f=(n(54),n(45)),v=n.n(f),p=function t(e,n,i,o,s){Object(y.a)(this,t),this.ox=i,this.oy=o,this.x=e,this.y=n,this.tm=s,this.i=0},d=function(t){Object(l.a)(n,t);var e=Object(m.a)(n);function n(t){var i;return Object(y.a)(this,n),(i=e.call(this,t)).once=!1,i.bucketDoing=!1,i.choosenColor=[0,0,0],i.t0=performance.now(),i.t1=0,i.stack=0,i.offset={x:0,y:0},i.pos={x:0,y:0},i.drawWrapper=i.handlePlayerDrawing.bind(Object(h.a)(i)),i.setPositionWrapper=i.setPosition.bind(Object(h.a)(i)),i.width=800,i.height=600,i.timeoutInterval=setInterval((function(){var t=performance.now();t-i.t0>=200&&(i.t0=t)}),200),i}return Object(u.a)(n,[{key:"setPosition",value:function(t){this.pos.x=t.clientX-this.offset.x,this.pos.y=t.clientY-this.offset.y}},{key:"isSameColor",value:function(t,e,n,i){return 0!==t[4*(n*this.width+e)+3]}},{key:"fillIt",value:function(t,e,n){this.isSameColor(t,e,n,this.choosenColor)||(t[4*(n*this.width+e)+3]=255,e+1<800&&this.fillIt(t,e+1,n),n+1<600&&this.fillIt(t,e,n+1),e-1>=0&&this.fillIt(t,e-1,n),n-1>=0&&this.fillIt(t,e,n-1)),this.stack-=1}},{key:"bucket",value:function(t,e){var n=this;if(!this.bucketDoing){this.bucketDoing=!0,setTimeout((function(){n.bucketDoing=!1}),1e4),console.log("BUCKET CALL!");var i=this.ctx.getImageData(0,0,800,600),o=i.data;console.log(o),this.fillIt(o,t,e),this.ctx.putImageData(i,0,0),console.log("endend...",this.stack)}}},{key:"drawPixel",value:function(){var t=this.props.instructionArray.array[this.props.instructionArray.index];this.ctx.beginPath(),this.ctx.lineWidth=4,this.ctx.lineCap="round",this.ctx.strokeStyle="#c0392b",this.ctx.moveTo(t.ox,t.oy),this.ctx.lineTo(t.x,t.y),this.ctx.stroke()}},{key:"handlePlayerDrawing",value:function(t){var e=0;if(1===t.buttons){if(!0!==this.props.blocked)return this.setPosition(t),this.bucket(this.pos.x,this.pos.y);this.ctx.beginPath();var n,i,o,s={x:this.pos.x,y:this.pos.y};this.ctx.moveTo(this.pos.x,this.pos.y),this.setPosition(t),this.ctx.lineTo(this.pos.x,this.pos.y),this.ctx.stroke(),this.t1=performance.now(),console.log(this.t1-this.t0),n=0,i=1e3,o=Math.floor(this.t1-this.t0),e=Math.min(Math.max(n,o),i),this.props.instructionArray.array.push(new p(this.pos.x,this.pos.y,s.x,s.y,e)),this.t0=this.t1;var a=this.ctx.getImageData(0,0,800,600).data;console.log(a)}}},{key:"componentDidUpdate",value:function(t,e,n){console.log("UP ",this.props.blocked),this.mouseMoveEvent=document.addEventListener("mousemove",this.drawWrapper),this.mouseDownEvent=document.addEventListener("mousedown",this.setPositionWrapper),this.mouseEnterEvent=document.addEventListener("mouseenter",this.setPositionWrapper)}},{key:"componentDidMount",value:function(){this.offset={x:this.canvasRef.offsetLeft,y:this.canvasRef.offsetTop},this.ctx=this.canvasRef.getContext("2d"),this.ctx.strokeStyle="#000000",console.log("didmount")}},{key:"componentWillUnmount",value:function(){this.mouseDownEvent.remove(),this.mouseEnterEvent.remove(),this.mouseMoveEvent.remove(),clearInterval(this.timeoutInterval),console.log("unmount")}},{key:"render",value:function(){var t=this;return o.a.createElement("canvas",{id:"myCanvas",width:"800",height:"600",ref:function(e){console.log("REF BRO: ",e),t.canvasRef=e,console.log("af ",t.canvasRef)}},"D\xe9sol\xe9, votre navigateur ne prend pas en charge <canvas>.")}}]),n}(o.a.Component),g=function t(){Object(y.a)(this,t),this.array=[],this.index=0},k=function(){function t(e,n,i,o,s){Object(y.a)(this,t),this.gameMessageInstructions=s,this.instructionArray=i,this.networkInstruction=o,this.interval=null,this.handleInstructionTimeout=null,this.parent=e,this.URL=n}return Object(u.a)(t,[{key:"handleInstructionArray",value:function(t){var e=!0===t?null:this.handleInstructionArray.bind(this);if(this.instructionArray.index>=this.instructionArray.array.length)return this.instructionArray.index=0,void(this.instructionArray.array=null);this.networkInstruction[this.instructionArray.array[this.instructionArray.index].i](this.instructionArray),this.instructionArray.index+=1,e&&(this.handleInstructionTimeout=setTimeout(e,this.instructionArray.array[this.instructionArray.index-1].tm))}},{key:"rush",value:function(){for(this.handleInstructionTimeout&&clearTimeout(this.handleInstructionTimeout);this.instructionArray.index<this.instructionArray.array.length;this.instructionArray.index++)this.networkInstruction[this.instructionArray.array[this.instructionArray.index].i](this.instructionArray);this.instructionArray.array=[],this.instructionArray.index=0}},{key:"componentWillUnmount",value:function(){clearInterval(this.handleInstructionTimeout)}},{key:"setupSocket",value:function(){var t=this,e=new URLSearchParams(window.location.search);this.socket=v()(this.URL,{reconnect:!0,query:"roomName=".concat(e.get("roomName"))}),this.socket.on("gameData",(function(e){t.gameMessageInstructions.gameData&&t.gameMessageInstructions.gameData(),null!=t.instructionArray.array&&t.rush(t.instructionArray),console.log("Je recois -> ",e),t.instructionArray.array=e,t.instructionArray.index=0,t.handleInstructionArray(!1)})),this.socket.on("newPlayerTurn",(function(){t.gameMessageInstructions.newPlayerTurn&&t.gameMessageInstructions.newPlayerTurn(),function(){for(var t=(new Date).toISOString().substring(0,19).replace("T"," "),e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];console.log(t+" : "+n.join(""))}("LETS GO!"),t.interval=setInterval((function(){console.log(" interval  data ",t.instructionArray),t.instructionArray.array.length>2&&(t.socket.emit("gameData",t.instructionArray.array),t.instructionArray.array=[],t.instructionArray.index=0)}),1e3)}))}}]),t}(),x=function(t){Object(l.a)(n,t);var e=Object(m.a)(n);function n(t){var i;Object(y.a)(this,n),i=e.call(this,t);var o=new URLSearchParams(window.location.search);return i.instructionArray=new g,i.roomName=o.get("roomName"),i.socket=null,i.state={playerTurn:!0},i}return Object(u.a)(n,[{key:"handleNewPlayerTurn",value:function(){this.setState({playerTurn:!0})}},{key:"handleNoAccessCanvas",value:function(){!1!==this.state.playerTurn&&this.setState({playerTurn:!1})}},{key:"componentDidMount",value:function(){this.gameServerInstruction=[this.canvasRef.drawPixel.bind(this.canvasRef)],this.messageServerInstruction={newPlayerTurn:this.handleNewPlayerTurn.bind(this)},this.socket||(this.socket=new k(this,"http://appskr-env.eba-ufuzuuq8.us-east-1.elasticbeanstalk.com",this.instructionArray,this.gameServerInstruction,this.messageServerInstruction),this.socket.setupSocket())}},{key:"render",value:function(){var t=this;return[o.a.createElement(d,{ref:function(e){return t.canvasRef=e},blocked:this.state.playerTurn,instructionArray:this.instructionArray}),o.a.createElement("button",{className:"favorite styled",type:"button",onClick:function(){console.log("clicj"),t.setState({playerTurn:!0!==t.state.playerTurn})}},"Add to favorites")]}}]),n}(o.a.Component),b="http://appskr-env.eba-ufuzuuq8.us-east-1.elasticbeanstalk.com",w=function(t){Object(l.a)(n,t);var e=Object(m.a)(n);function n(t){var i;return Object(y.a)(this,n),(i=e.call(this,t)).state={joinRoomText:"",newRoomText:""},i}return Object(u.a)(n,[{key:"newRoomCallback",value:function(t){!0===t.success?this.props.history.push("/game?roomName=".concat(t.roomName)):alert("Something went wrong : ".concat(t.error))}},{key:"joinRoomCallback",value:function(t){console.log("res ",t),!0===t.success?this.props.history.push("/game?roomName=".concat(t.roomName)):alert("Something went wrong : ".concat(t.error))}},{key:"newRoom",value:function(){0!==this.state.newRoomText.length?fetch("".concat(b,"/newroom/").concat(this.state.newRoomText,"/"),{mode:"no-cors"}).then((function(t){return t.json()})).then(this.newRoomCallback.bind(this)):alert("Please enter a roomName")}},{key:"joinRoom",value:function(){console.log("lol"),0!==this.state.joinRoomText.length?fetch("".concat(b,"/joinroom/").concat(this.state.joinRoomText,"/"),{mode:"no-cors"}).then((function(t){return console.log(t),t.json()})).then(this.joinRoomCallback.bind(this)):alert("Please enter a roomName")}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var t=this;return o.a.createElement("div",null,o.a.createElement("input",{class:"myButton",placeholder:"Enter new room name name",onChange:function(e){return t.setState({newRoomText:e.target.value})}}),o.a.createElement("input",{name:"Submit",type:"submit",onClick:this.newRoom.bind(this)}),o.a.createElement("input",{class:"myButton",id:"joinRoomName",placeholder:"Enter existing room name",onChange:function(e){return t.setState({joinRoomText:e.target.value})}}),o.a.createElement("input",{name:"Submit",type:"submit",onClick:this.joinRoom.bind(this)}))}}]),n}(o.a.Component),A=function(){return o.a.createElement(r.a,null,o.a.createElement(c.c,null,o.a.createElement(c.a,{exact:!0,path:"/",component:w}),o.a.createElement(c.a,{path:"/game"},o.a.createElement(x,null))))};a.a.render(o.a.createElement(A,null),document.getElementById("root"));e.default=A}},[[49,1,2]]]);
//# sourceMappingURL=main.9f8342a5.chunk.js.map